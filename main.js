!function(t){var e={};function n(i){if(e[i])return e[i].exports;var a=e[i]={i:i,l:!1,exports:{}};return t[i].call(a.exports,a,a.exports,n),a.l=!0,a.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)n.d(i,a,function(e){return t[e]}.bind(null,a));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=0)}([function(t,e,n){"use strict";function i(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}n.r(e);var a=function(){function t(e,n,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audio=e,this.canvas=n,this.icon=i,this.context=this.canvas.getContext("2d")}var e,n,a;return e=t,(n=[{key:"initArray",value:function(){var t=new(window.AudioContext||window.webkitAudioContext);this.analyser=t.createAnalyser(),t.createMediaElementSource(this.audio).connect(this.analyser),this.analyser.connect(t.destination),this.dataArray=new Uint8Array(this.analyser.frequencyBinCount)}},{key:"initCanvas",value:function(){this.canvas.width=window.innerWidth,this.canvas.height=window.innerHeight,this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2}},{key:"stop",value:function(){this.setIcon("paused"),this.initCanvas(),window.cancelAnimationFrame(this.requestID)}},{key:"animate",value:function(){this.dataArray||this.initArray(),this.audio&&this.audio.readyState<3?this.setIcon("loading"):this.setIcon("playing"),this.initCanvas(),this.analyser.getByteFrequencyData(this.dataArray);for(var t=0;t<200;t+=1){var e=2*Math.PI/200,n=.7*this.dataArray[t],i=this.centerX+100*Math.cos(e*t),a=this.centerY+100*Math.sin(e*t),r=this.centerX+Math.cos(e*t)*(100+n),s=this.centerY+Math.sin(e*t)*(100+n);this.drawBar(i,a,r,s,2,this.dataArray[t])}this.requestID=window.requestAnimationFrame(this.animate.bind(this))}},{key:"drawBar",value:function(t,e,n,i,a,r){this.context.strokeStyle="rgb(255, 255, 255)",this.context.lineWidth=a,this.context.beginPath(),this.context.moveTo(t,e),this.context.lineTo(n,i),this.context.stroke()}},{key:"setIcon",value:function(t){var e;"paused"===t?e="fa-play":"playing"===t?e="fa-pause":"loading"===t&&(e="fa-spinner fa-pulse"),this.icon.className="fas ".concat(e," fa-2x")}}])&&i(e.prototype,n),a&&i(e,a),t}();function r(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}var s=function(){function t(e,n){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.audio=e,this.canvas=n,this.playing=!1,this.visualiser=new a(this.audio,this.canvas,document.getElementById("icon"))}var e,n,i;return e=t,(n=[{key:"init",value:function(t){var e=this;t.addEventListener("click",(function(){!1===e.playing?e.play():e.pause()}))}},{key:"play",value:function(){this.playing=!0,this.audio.play(),this.visualiser.animate()}},{key:"pause",value:function(){this.playing=!1,this.audio.pause(),this.visualiser.stop()}}])&&r(e.prototype,n),i&&r(e,i),t}();function o(t){var e,n=0;void 0!==t.icestats.source.listeners&&(n=t.icestats.source.listeners),void 0!==t.icestats.source[0]&&((e=t.icestats.source[0])&&e.constructor===Object)&&(n=t.icestats.source.reduce((function(t,e){return t+e.listeners}),0)),document.getElementById("listeners").innerHTML=n}document.addEventListener("DOMContentLoaded",(function(){new s(document.getElementById("audio"),document.getElementById("renderer")).init(document.getElementById("button"))})),function t(){var e=fetch("https://radio.fam.wtf/status-json.xsl",{mode:"no-cors"}).then((function(t){return t.json()})).then((function(t){return o(t)})),n=new Promise((function(t){setTimeout(t,1e4)}));Promise.all([e,n]).then((function(){t()}))}()}]);
//# sourceMappingURL=main.js.map